<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="color-scheme" content="light dark">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script>
    // Run immediately to avoid flash-of-wrong-theme (FOWT)
    (function() {
      try {
        // priority: localStorage -> system preference -> light
        var stored = localStorage.getItem('theme');
        var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        var useDark = stored === 'dark' || (!stored && prefersDark);
        if (useDark) document.documentElement.classList.add('dark');
        else document.documentElement.classList.remove('dark');
        // useful for debugging
        document.documentElement.dataset.initialTheme = useDark ? 'dark' : 'light';
      } catch (e) {
        // ignore if localStorage is blocked
      }
    })();
  </script>

  <title>HAMPER GIFT INDIAN - Premium Gifting</title>

  <script>tailwind = window.tailwind || {}; tailwind.config = { darkMode: 'class' };</script>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>

  <style>
    /* ---------- Base ---------- */
    :root{
      --muted: #4B5563;
      --brand: #6C2BD9;
      --brand-dark: #5821b0;
      --bg: #F9FAFB;
      --surface: #FFFFFF;
      --glass: rgba(255,255,255,0.6);

      /* Theme fallback variables (used by .card-theme) */
      --card-bg: #FFFFFF;
      --card-text: #1F2937;
      --muted-text: #4B5563;
    }

    html.dark{
      --muted: #E5E7EB;
      --bg: #0B1020;
      --surface: #0F1724;
      --glass: rgba(17,24,39,0.65);

      /* theme fallback variables for dark */
      --card-bg: #0F1724;
      --card-text: #E5E7EB;
      --muted-text: #9CA3AF;
    }

    html,body{
      height:100%;
      margin:0;
      padding:0;
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--muted);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      transition: background-color .25s ease, color .25s ease;
    }

    h1,h2,h3,h4{
      font-family: 'Poppins', sans-serif;
      color: #1F2937;
    }
    html.dark h1,h2,h3,h4{ color:#FFFFFF; }

    /* Fallback "card-theme" ensures cards & titles change even if Tailwind classes don't apply */
    .card-theme {
      background-color: var(--card-bg) !important;
      color: var(--card-text) !important;
    }
    .card-theme h3,
    .card-theme p,
    .card-theme span,
    .card-theme .price {
      color: inherit !important;
    }

    /* Loader */
    .loader {
      border: 4px solid rgba(255,255,255,0.18);
      border-top: 4px solid var(--brand);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    .grid-loader .loader {
      border: 4px solid rgba(0,0,0,0.08);
      border-top: 4px solid var(--brand);
    }
    @keyframes spin { 0%{transform:rotate(0)}100%{transform:rotate(360deg)} }

    /* Confetti */
    .confetti-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; pointer-events: none; z-index: 9999; }
    .confetti { position: absolute; width: 10px; height: 10px; opacity: .95; animation: confetti-fall 4s ease-out forwards; border-radius: 2px; }
    @keyframes confetti-fall { 0% { transform: translateY(-10vh) rotate(0deg); opacity:1; } 100% { transform: translateY(110vh) rotate(720deg); opacity:0; } }

    /* Hero Carousel */
    #hero-carousel { position: relative; overflow: hidden; border-radius: 12px; }
    .carousel-item { position: absolute; inset: 0; opacity: 0; transition: opacity 1s ease-in-out, transform 1s ease; background-size: cover; background-position: center; will-change: opacity; }
    .carousel-item.active { opacity: 1; transform: translateZ(0); }

    .carousel-dot { width: 10px; height: 10px; border-radius: 999px; background-color: #9ca3af; cursor: pointer; transition: background-color .25s; }
    .carousel-dot.active { background-color: var(--brand); box-shadow: 0 0 8px rgba(108,43,217,0.18); }

    /* Feedback image */
    #feedback-image { transition: opacity 700ms ease; background-color: #E5E7EB; display:block; }

    /* Small classy tweaks */
    header.backglass { background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.55)); backdrop-filter: blur(6px); }
    html.dark header.backglass { background: linear-gradient(180deg, rgba(8,10,14,0.65), rgba(8,10,14,0.55)); }

    /* Ensure modals animate nicely */
    .modal-panel { transform-origin:center; transition: transform .25s ease, opacity .25s ease; }

    /* enforce 30x30 images for social icons */
    .social-icon { width: 30px; height: 30px; object-fit: contain; display:inline-block; }
  </style>
</head>

<body class="antialiased">
  <div id="global-loader" class="fixed inset-0 bg-gray-900 bg-opacity-60 z-[100] flex items-center justify-center hidden">
    <div class="loader"></div>
  </div>

  <div id="app-container" class="min-h-screen">
    <header class="sticky top-0 z-40 backglass shadow-md">
      <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center space-x-4">
            <img id="brand-logo" alt="Logo" class="h-10 w-10 rounded-full object-cover" src="logo.png">
            <span id="brand-name" class="text-xl font-bold text-[#6C2BD9] dark:text-purple-400"></span>
          </div>

          <div class="flex items-center space-x-4">
            <button id="theme-toggle" aria-label="Toggle theme" class="p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-[#6C2BD9]" aria-pressed="false">
              <svg id="theme-icon-light" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
              </svg>
              <svg id="theme-icon-dark" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
              </svg>
            </button>
          </div>
        </div>
      </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div id="hero-carousel" class="relative w-full h-56 sm:h-80 md:h-96 mb-6 shadow-2xl rounded-xl overflow-hidden"></div>
      <div id="carousel-dots" class="flex justify-center space-x-2 mb-12"></div>

      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-extrabold">Curated Gifts, Delivered with Love</h1>
        <p class="mt-4 text-lg text-[#4B5563] dark:text-gray-400 max-w-2xl mx-auto">Find the perfect gift for every occasion, handcrafted and delivered across India.</p>
      </div>

      <div id="grid-loader" class="flex justify-center items-center h-64">
        <div class="loader"></div>
      </div>

      <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></div>
    </main>

    <footer class="bg-[#F9FAFB] dark:bg-gray-800 mt-16">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="mb-12">
          <h3 class="text-3xl font-bold text-center mb-8">What Our Clients Say</h3>
          <div class="flex justify-center">
            <div class="relative mx-auto border-[#E5E7EB] dark:border-gray-700 bg-white dark:bg-gray-800 border-[14px] rounded-[2.5rem] h-[650px] w-[300px] shadow-2xl">
              <div class="w-[148px] h-[18px] bg-white dark:bg-gray-800 top-0 rounded-b-[1rem] left-1/2 -translate-x-1/2 absolute"></div>
              <div class="h-[46px] w-[3px] bg-white dark:bg-gray-800 absolute -start-[17px] top-[124px] rounded-s-lg"></div>
              <div class="h-[46px] w-[3px] bg-white dark:bg-gray-800 absolute -start-[17px] top-[178px] rounded-s-lg"></div>
              <div class="h-[64px] w-[3px] bg-white dark:bg-gray-800 absolute -end-[17px] top-[142px] rounded-e-lg"></div>

              <div class="rounded-[2rem] overflow-hidden w-full h-full bg-white dark:bg-gray-900 flex flex-col p-2">
                <img id="feedback-image" class="w-full h-full object-cover rounded-2xl flex-grow" alt="Client Feedback" src="https://placehold.co/272x572/f3f4f6/333333?text=Loading...">
                <div class="flex-shrink-0 pt-2 text-center">
                  <div class="flex justify-center items-center space-x-2">
                    <button id="prev" class="px-3 py-1 text-sm font-semibold rounded-lg bg-gray-200 dark:bg-gray-700 text-[#1F2937] dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">Prev</button>
                    <button id="pause" class="px-4 py-1 text-sm font-semibold rounded-lg bg-[#6C2BD9] text-white hover:bg-[#5821b0] transition-colors">Pause</button>
                    <button id="next" class="px-3 py-1 text-sm font-semibold rounded-lg bg-gray-200 dark:bg-gray-700 text-[#1F2937] dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">Next</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="text-center text-[#4B5563] dark:text-gray-400 pt-8 border-t border-[#E5E7EB] dark:border-gray-700">
          <p class="mb-4">&copy; 2024 <span id="footer-brand-name"></span>. All Rights Reserved.</p>
          <div class="flex justify-center items-center space-x-6">
            <a id="instagram-link" href="#" target="_blank" rel="noopener noreferrer" class="hover:text-[#6C2BD9] transition-colors">
              <img id="instagram-img" class="social-icon" src="insta.png" alt="Instagram">
            </a>

            <a id="email-link" href="#" class="hover:text-[#6C2BD9] transition-colors">
              <img id="email-img" class="social-icon" src="email.png" alt="Email">
            </a>
          </div>

          <p class="text-sm mt-4">Made with ❤️ by <a href="https://xceedjs.com" target="_blank" rel="noopener noreferrer" class="font-semibold text-[#6C2BD9] hover:text-[#16A34A] transition-colors">XCEEDJS</a></p>
        </div>
      </div>
    </footer>
  </div>

  <div id="order-form-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 hidden">
    <div class="modal-panel bg-[#FFFFFF] dark:bg-gray-800 rounded-lg shadow-xl p-6 md:p-8 w-full max-w-md transform transition-all duration-300 scale-95 opacity-0">
      <h2 class="text-2xl font-bold mb-4 text-center text-[#1F2937] dark:text-white">Complete Your Order</h2>
      <p class="text-center mb-1 text-[#4B5563] dark:text-gray-400">For: <span id="form-product-name" class="font-semibold"></span></p>
      <p class="text-center mb-6 text-lg text-[#6C2BD9] dark:text-[#8b5cf6] font-bold">Amount: ₹<span id="form-product-price"></span></p>
      
      <form id="customer-form" class="space-y-4" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSfEs-MGV92tBUy7p4_ffLtKt4FiFOLMp3N2ycYC-FT8z_4i2A/formResponse" method="POST" target="hidden_iframe">
        <input type="text" id="name" name="entry.1806644321" placeholder="Full Name" required class="w-full px-4 py-2 border border-[#E5E7EB] dark:border-gray-600 rounded-md bg-[#F9FAFB] dark:bg-gray-700 text-[#1F2937] dark:text-white focus:outline-none focus:ring-2 focus:ring-[#6C2BD9]">
        <input type="tel" id="phone" name="entry.1158388916" placeholder="Phone Number" required class="w-full px-4 py-2 border border-[#E5E7EB] dark:border-gray-600 rounded-md bg-[#F9FAFB] dark:bg-gray-700 text-[#1F2937] dark:text-white focus:outline-none focus:ring-2 focus:ring-[#6C2BD9]">
        <textarea id="address" name="entry.576025484" placeholder="Full Delivery Address" required rows="3" class="w-full px-4 py-2 border border-[#E5E7EB] dark:border-gray-600 rounded-md bg-[#F9FAFB] dark:bg-gray-700 text-[#1F2937] dark:text-white focus:outline-none focus:ring-2 focus:ring-[#6C2BD9]"></textarea>
        <input type="text" id="reel-link" name="entry.1541297937" placeholder="Link of Reel (if any)" class="w-full px-4 py-2 border border-[#E5E7EB] dark:border-gray-600 rounded-md bg-[#F9FAFB] dark:bg-gray-700 text-[#1F2937] dark:text-white focus:outline-none focus:ring-2 focus:ring-[#6C2BD9]">
        
        <input type="hidden" id="form-amount-hidden" name="entry.241375567">
        <input type="hidden" id="form-ip-hidden" name="entry.1995640183">

        <div class="flex flex-col sm:flex-row gap-4 pt-4">
          <button type="button" id="cancel-order" class="w-full bg-[#E5E7EB] text-[#1F2937] dark:bg-gray-600 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-all">Cancel</button>
          <button type="submit" class="w-full bg-[#6C2BD9] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#5821b0] transition-all shadow-lg shadow-purple-500/30">Proceed to Pay</button>
        </div>
      </form>
    </div>
  </div>

  <div id="payment-options-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 hidden">
    <div class="modal-panel bg-[#FFFFFF] dark:bg-gray-800 rounded-lg shadow-xl p-6 md:p-8 w-full max-w-sm text-center transform transition-all duration-300 scale-95 opacity-0">
      <h2 class="text-2xl font-bold mb-4 text-[#1F2937] dark:text-white">Choose a Payment Method</h2>
      <p class="text-[#4B5563] dark:text-gray-400 mb-6">Select your preferred UPI app to continue.</p>
      <div class="flex flex-col sm:flex-row gap-4 pt-4">
        <button type="button" id="phonepay-btn" class="w-full bg-[#E5E7EB] text-[#1F2937] dark:bg-gray-600 dark:text-gray-200 font-bold py-3 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-all">PHONE-PAY</button>
        <button type="button" id="paytm-btn" class="w-full bg-[#6C2BD9] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#5821b0] transition-all shadow-lg shadow-purple-500/30">PAYTM</button>
      </div>
    </div>
  </div>
  
  <div id="qr-code-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 hidden">
    <div class="modal-panel bg-[#FFFFFF] dark:bg-gray-800 rounded-lg shadow-xl p-6 md:p-8 w-full max-w-sm text-center transform transition-all duration-300 scale-95 opacity-0">
      <h2 class="text-2xl font-bold mb-2 text-[#1F2937] dark:text-white">Scan to Pay</h2>
      <p id="qr-payment-method" class="text-[#4B5563] dark:text-gray-400 mb-2"></p>
      <p class="text-[#4B5563] dark:text-gray-400 mb-4">Pay <strong class="text-[#6C2BD9] dark:text-[#8b5cf6]">₹<span id="qr-amount"></span></strong> using any UPI app</p>
      <div id="qrcode" class="flex justify-center items-center p-2 bg-white rounded-md my-4 min-h-[200px]"></div>
      <p class="text-sm text-gray-500 dark:text-gray-400">UPI ID: <span id="upi-id-display" class="font-mono"></span></p>
      <button id="paid-button" class="mt-6 w-full bg-[#16A34A] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#15803d] transition-all shadow-lg shadow-green-500/30">I Have Paid</button>
    </div>
  </div>

  <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 hidden">
    <div class="confetti-container"></div>
    <div class="modal-panel bg-[#FFFFFF] dark:bg-gray-800 rounded-lg shadow-xl p-8 w-full max-w-md text-center transform transition-all duration-300 scale-95 opacity-0">
      <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900 mb-4">
        <svg class="h-10 w-10 text-[#16A34A] dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <h2 class="text-2xl font-bold mb-2 text-[#1F2937] dark:text-white">Payment Confirmed!</h2>
      <p class="text-[#4B5563] dark:text-gray-400">Our team will contact you shortly. Thank you for your order!</p>
    </div>
  </div>
  
  <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // =================================================================================
      // --- CONFIGURATION - EDIT YOUR WEBSITE DETAILS HERE ---
      // =================================================================================
      const CONFIG = {
        brandName: 'HAMPER GIFT INDIAN',
        // upiId: 'yshalsingh6@fam',
        upiId: 'hemalatadevi4889@naviaxis',
        
        email: 'hampergiftindian@gmail.com',
        instagramUrl: 'https://www.instagram.com/hampergift_indian/',
        heroImages: ['cr1.jpg','cr2.jpg','cr3.jpg','cr4.jpg'],
        productData: [
          { name: "MEN's Hamper", description: '', price: 2500, image: 'h1.png' } ,
          { name: "Box Hamper-1", description: '', price: 2000, image: 'h2.png' },
          { name: "EID SPECIAL", description: '', price: 3000, image: 'h3.png' },
          { name: "GIRLFriend's special", description: '', price: 3400, image: 'h4.png' },
          { name: "New born baby mini trolley hamper", description: '', price: 1900, image: 'h5.png' },
          { name: "Engagement hamper series", description: '', price: 4000, image: 'h6.png' },
          { name: "GirlFriend's Birthday Hamper", description: '', price: 2100, image: 'h7.png' },
          { name: "Men's Executive Hamper", description: 'A sophisticated gift with a premium shirt, watch, wallet, and perfume.', price: 2300, image: 'photo1.jpg' },
          { name: 'Floral Vanity Trunk', description: 'A beautiful and reusable trunk adorned with fresh flowers and custom text.', price: 1500, image: 'photo2.jpg' },
          { name: 'Decadent Chocolate Bouquet', description: 'An irresistible bouquet of assorted premium chocolates for the sweet tooth.', price: 1000, image: 'photo3.jpg' },
          { name: "Men's Classic Combo", description: 'The perfect combo featuring a stylish plaid shirt, belt, wallet, and more.', price: 2600, image: 'photo4.jpg' },
          { name: 'Elegant Maroon Hamper', description: 'A rich, color-themed hamper for him, complete with essentials and treats.', price: 2000, image: 'photo5.jpg' },
          { name: 'Sweet Memories Box', description: 'A charming pink gift box perfect for birthdays, filled with delightful surprises.', price: 1300, image: 'photo6.jpg' },
          { name: 'Anniversary Surprise Trunk', description: 'Celebrate your special day with this elegant black trunk, customized for you.', price: 2000, image: 'photo7.jpg' },
          { name: 'Pastel Dream Vanity', description: 'A lovely vanity case in a soothing pastel shade, perfect for any celebration.', price: 2000, image: 'photo8.jpg' },
          { name: "The Gentleman's Grooming Kit", description: 'A curated kit with premium shaving cream, a classic razor, aftershave balm, and a beard brush.', price: 1800, image: 'photo9.jpg' },
          { name: 'Artisan Cheese & Wine Basket', description: 'Gourmet cheeses, crackers, and a bottle of fine red wine.', price: 2500, image: 'photo10.jpg' },
          { name: 'Personalized Photo Album', description: 'Leather-bound album personalized with name or message.', price: 1200, image: 'photo11.jpg' },
          { name: 'Spa Day Retreat Box', description: 'Bath bombs, scented candles, luxurious lotions for a spa day at home.', price: 1600, image: 'photo12.jpg' },
          { name: "Coffee Lover's Dream Box", description: 'Premium coffee beans, French press, and ceramic mug.', price: 1900, image: 'photo13.jpg' } ,
          { name: "I PHONE 16 PRO MAX", description: 'I phone 16 pro max 128 GB varient only', price:3590 , image: 'iphone.jpg' } ,

          
        ],
        feedbackImages: ['feedback1.jpg','feedback2.jpg','feedback3.jpg','feedback4.jpg','feedback5.jpg','feedback6.jpg']
      };
      // =================================================================================
      // --- END OF CONFIG ---
      // =================================================================================

      // Initialize content
      document.getElementById('brand-name').textContent = CONFIG.brandName;
      document.getElementById('footer-brand-name').textContent = CONFIG.brandName;
      document.getElementById('email-link').href = `mailto:${CONFIG.email}`;
      document.getElementById('instagram-link').href = CONFIG.instagramUrl;
      const logoEl = document.getElementById('brand-logo');
      logoEl.src = 'logo.png';
      logoEl.alt = CONFIG.brandName + " logo";
      logoEl.addEventListener('error', () => {
        logoEl.src = `https://placehold.co/40x40/6C2BD9/FFFFFF?text=${encodeURIComponent(CONFIG.brandName.split(' ')[0]||'H')}`;
      });

      // Theme controls
      const themeToggleBtn = document.getElementById('theme-toggle');
      const themeIconLight = document.getElementById('theme-icon-light');
      const themeIconDark = document.getElementById('theme-icon-dark');
      const htmlEl = document.documentElement;

      function applyThemeVisuals(isDark) {
        if (isDark) {
          htmlEl.classList.add('dark');
          themeIconDark.classList.remove('hidden');
          themeIconLight.classList.add('hidden');
          themeToggleBtn.setAttribute('aria-pressed', 'true');
        } else {
          htmlEl.classList.remove('dark');
          themeIconDark.classList.add('hidden');
          themeIconLight.classList.remove('hidden');
          themeToggleBtn.setAttribute('aria-pressed', 'false');
        }
      }

      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      let currentTheme = (savedTheme === 'dark' || (!savedTheme && prefersDark)) ? 'dark' : 'light';
      applyThemeVisuals(currentTheme === 'dark');

      themeToggleBtn.addEventListener('click', () => {
        const isDark = htmlEl.classList.toggle('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        applyThemeVisuals(isDark);
      });

      // HERO CAROUSEL
      const carouselContainer = document.getElementById('hero-carousel');
      const dotsContainer = document.getElementById('carousel-dots');
      const carouselImages = CONFIG.heroImages.slice();
      let currentSlide = 0;
      let slideInterval;

      function createSlides() {
        carouselContainer.innerHTML = '';
        dotsContainer.innerHTML = '';
        carouselImages.forEach((src, index) => {
          const slide = document.createElement('div');
          slide.className = 'carousel-item';
          slide.style.backgroundImage = `url(${src})`;
          slide.setAttribute('role','img');
          slide.setAttribute('aria-label', `Slide ${index+1}`);
          if (index === 0) slide.classList.add('active');
          carouselContainer.appendChild(slide);

          const dot = document.createElement('button');
          dot.className = 'carousel-dot';
          dot.setAttribute('aria-label', `Go to slide ${index+1}`);
          if (index === 0) dot.classList.add('active');
          dot.addEventListener('click', () => { showSlide(index); resetInterval(); });
          dotsContainer.appendChild(dot);
        });
      }

      function showSlide(index) {
        const slides = carouselContainer.querySelectorAll('.carousel-item');
        const dots = dotsContainer.querySelectorAll('.carousel-dot');
        index = ((index % slides.length) + slides.length) % slides.length;
        slides.forEach((slide,i) => slide.classList.toggle('active', i===index));
        dots.forEach((dot,i) => dot.classList.toggle('active', i===index));
        currentSlide = index;
      }
      function nextSlide(){ const slides = carouselContainer.querySelectorAll('.carousel-item'); showSlide((currentSlide+1)%slides.length); }
      function prevSlide(){ const slides = carouselContainer.querySelectorAll('.carousel-item'); showSlide((currentSlide-1+slides.length)%slides.length); }
      function startCarousel(){ stopCarousel(); slideInterval = setInterval(nextSlide, 5000); }
      function stopCarousel(){ if (slideInterval){ clearInterval(slideInterval); slideInterval=null; } }
      function resetInterval(){ stopCarousel(); startCarousel(); }

      let touchStartX = null;
      carouselContainer.addEventListener('touchstart', (e)=>{ stopCarousel(); touchStartX = e.touches ? e.touches[0].clientX : null; }, {passive:true});
      carouselContainer.addEventListener('touchend', (e)=> {
        if (touchStartX == null) { startCarousel(); return; }
        const touchEndX = e.changedTouches ? e.changedTouches[0].clientX : null;
        if (touchEndX == null) { startCarousel(); return; }
        const dx = touchEndX - touchStartX;
        if (Math.abs(dx) > 40) { if (dx < 0) nextSlide(); else prevSlide(); }
        touchStartX = null;
        startCarousel();
      }, {passive:true});

      if (carouselImages.length > 0) { createSlides(); startCarousel(); }

      // PRODUCTS
      const productGrid = document.getElementById('product-grid');
      const gridLoader = document.getElementById('grid-loader');

      const renderProducts = () => {
        productGrid.innerHTML = '';
        CONFIG.productData.forEach(product => {
          const card = document.createElement('div');
          card.className = 'card-theme bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300 group';
          const placeholderImg = `https://placehold.co/400x300/c4b5fd/1F2937?text=${encodeURIComponent(product.name)}`;
          const finalImgSrc = product.image ? product.image : placeholderImg;

          card.innerHTML = `
            <div class="relative">
              <img class="w-full h-56 object-cover" src="${finalImgSrc}" alt="${product.name}" onerror="this.onerror=null;this.src='${placeholderImg}';">
              <div class="absolute inset-0 bg-black bg-opacity-10 group-hover:bg-opacity-30 transition-all duration-300"></div>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-bold text-[#1F2937] dark:text-white">${product.name}</h3>
              <p class="mt-2 text-[#4B5563] dark:text-gray-400 h-12">${product.description}</p>
              <div class="flex justify-between items-center mt-4">
                <span class="text-2xl font-bold price text-[#6C2BD9] dark:text-[#8b5cf6]">₹${product.price}</span>
                <button data-name="${product.name}" data-price="${product.price}" class="buy-now-btn bg-[#6C2BD9] text-white font-bold py-2 px-5 rounded-lg hover:bg-[#5821b0] transition-colors shadow-md">Buy Now</button>
              </div>
            </div>`;
          productGrid.appendChild(card);
        });
      };

      setTimeout(()=> {
        gridLoader.style.display = 'none';
        renderProducts();
        attachBuyNowListeners();
      }, 1500);

      // MODALS & FORM
      const globalLoader = document.getElementById('global-loader');
      const orderFormModal = document.getElementById('order-form-modal');
      const qrCodeModal = document.getElementById('qr-code-modal');
      const successModal = document.getElementById('success-modal');
      const customerForm = document.getElementById('customer-form');
      const cancelOrderBtn = document.getElementById('cancel-order');
      const paidButton = document.getElementById('paid-button');
      
      // New payment option buttons
      const paymentOptionsModal = document.getElementById('payment-options-modal');
      const phonepayBtn = document.getElementById('phonepay-btn');
      const paytmBtn = document.getElementById('paytm-btn');
      
      let currentProduct = {};
      let selectedPaymentMethod = '';

      const showModal = (modal) => {
        modal.classList.remove('hidden');
        const panel = modal.querySelector('.modal-panel') || modal.querySelector('div');
        setTimeout(()=> { panel.classList.remove('scale-95','opacity-0'); }, 10);
      };
      const hideModal = (modal) => {
        const panel = modal.querySelector('.modal-panel') || modal.querySelector('div');
        panel.classList.add('scale-95','opacity-0');
        setTimeout(()=> modal.classList.add('hidden'), 300);
      };
      const showLoader = () => globalLoader.classList.remove('hidden');
      const hideLoader = () => globalLoader.classList.add('hidden');

      function attachBuyNowListeners() {
        document.querySelectorAll('.buy-now-btn').forEach(button => {
          button.addEventListener('click', (e) => {
            currentProduct.name = e.target.dataset.name;
            currentProduct.price = e.target.dataset.price;
            showLoader();
            setTimeout(()=> {
              hideLoader();
              document.getElementById('form-product-name').textContent = currentProduct.name;
              document.getElementById('form-product-price').textContent = currentProduct.price;
              showModal(orderFormModal);
            }, 500);
          });
        });
      }

      cancelOrderBtn.addEventListener('click', () => hideModal(orderFormModal));

      // =========== UPDATED FORM SUBMISSION LOGIC ===========
      customerForm.addEventListener('submit', (e) => {
          e.preventDefault();
          handleFormSubmission();
      });

      async function handleFormSubmission() {
          hideModal(orderFormModal);
          showLoader();

          // 1. Fetch IP Address
          let ipAddress = 'N/A';
          try {
            const response = await fetch('https://api.ipify.org?format=json');
            if (response.ok) {
              const data = await response.json();
              ipAddress = data.ip;
            }
          } catch (error) {
            console.error("Could not fetch IP address:", error);
          }
          // 2. Populate hidden fields
          document.getElementById('form-amount-hidden').value = currentProduct.price;
          document.getElementById('form-ip-hidden').value = ipAddress;

          // 3. Submit the form to the hidden iframe
          customerForm.submit();

          // 4. Show the payment options modal instead of QR code modal
          setTimeout(() => {
            hideLoader();
            showModal(paymentOptionsModal);
          }, 800); // Delay to ensure form submission is fired
      }
      // =======================================================

      // Handle payment option selection
      phonepayBtn.addEventListener('click', () => {
        selectedPaymentMethod = 'PhonePe';
        hideModal(paymentOptionsModal);
        generateQRCode();
        showModal(qrCodeModal);
      });

      paytmBtn.addEventListener('click', () => {
        selectedPaymentMethod = 'Paytm';
        hideModal(paymentOptionsModal);
        generateQRCode();
        showModal(qrCodeModal);
      });
      
      function generateQRCode() {
        const amount = currentProduct.price;
        const productName = currentProduct.name;
        const upiString = `upi://pay?pa=${CONFIG.upiId}&pn=${encodeURIComponent(CONFIG.brandName)}&am=${amount}&tn=Order%20for%20${encodeURIComponent(productName)}`;
        
        document.getElementById('qr-amount').textContent = amount;
        document.getElementById('upi-id-display').textContent = CONFIG.upiId;
        
        // Update QR code modal with selected payment method
        const paymentMethodEl = document.getElementById('qr-payment-method');
        paymentMethodEl.textContent = `Please pay using ${selectedPaymentMethod} to avoid any payment failure`;

        const qrContainer = document.getElementById('qrcode');
        qrContainer.innerHTML = '';
        try {
          const qr = qrcode(0,'L');
          qr.addData(upiString);
          qr.make();
          qrContainer.innerHTML = qr.createImgTag(5,4);
        } catch (err) {
          qrContainer.innerHTML = "Error generating QR code.";
          console.error(err);
        }
      }

      paidButton.addEventListener('click', () => {
        hideModal(qrCodeModal);
        showLoader();
        setTimeout(()=> { hideLoader(); showSuccess(); }, 1000);
      });

      function showSuccess() {
        showModal(successModal);
        triggerConfetti();
        setTimeout(()=> { hideModal(successModal); customerForm.reset(); }, 5000);
      }

      function triggerConfetti() {
        const container = document.querySelector('.confetti-container');
        container.innerHTML = '';
        const colors = ['#6C2BD9','#16A34A','#ec4899','#fde047','#4ade80'];
        for (let i=0;i<100;i++){
          const conf = document.createElement('div');
          conf.classList.add('confetti');
          conf.style.left = Math.random()*100 + 'vw';
          conf.style.animationDelay = Math.random()*2 + 's';
          conf.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
          conf.style.transform = `scale(${Math.random()*0.8 + 0.5})`;
          container.appendChild(conf);
        }
      }
      // FEEDBACK CAROUSEL
      const feedbackImages = CONFIG.feedbackImages;
      const feedbackImageEl = document.getElementById('feedback-image');
      let currentFeedbackIndex = 0;
      let intervalId = null;
      const CHANGE_MS = 4000;

      if (feedbackImages.length > 0) {
        feedbackImages.forEach(src => new Image().src = src); // preload

        function normIndex(i){ return ((i % feedbackImages.length) + feedbackImages.length) % feedbackImages.length; }

        function showImage(index) {
          index = normIndex(index);
          feedbackImageEl.style.opacity = 0;
          setTimeout(()=> {
            feedbackImageEl.src = feedbackImages[index];
            currentFeedbackIndex = index;
          }, 350);
        }
        feedbackImageEl.addEventListener('load', ()=> { feedbackImageEl.style.opacity = 1; });
        feedbackImageEl.addEventListener('error', ()=> {
          feedbackImageEl.src = 'https://placehold.co/272x572/ffdddd/333333?text=Image+Missing';
          feedbackImageEl.style.opacity = 1;
        });

        function nextImage(){ showImage(currentFeedbackIndex+1); }
        function prevImage(){ showImage(currentFeedbackIndex-1); }

        function startAuto(){ if (intervalId) return; intervalId = setInterval(nextImage, CHANGE_MS); document.getElementById('pause').textContent = 'Pause'; }
        function stopAuto(){ if (!intervalId) return; clearInterval(intervalId); intervalId=null; document.getElementById('pause').textContent = 'Resume'; }

        document.getElementById('next').addEventListener('click', ()=> { stopAuto(); nextImage(); });
        document.getElementById('prev').addEventListener('click', ()=> { stopAuto(); prevImage(); });
        document.getElementById('pause').addEventListener('click', ()=> { if (intervalId) stopAuto(); else startAuto(); });

        showImage(0);
        startAuto();
      }
    }); // DOMContentLoaded
  </script>
</body>
</html>
